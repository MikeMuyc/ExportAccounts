(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{IeaC:function(e,t,a){},Tybs:function(e,t,a){"use strict";a.r(t);var n=a("q1tI"),i=a.n(n),c=a("/MKj"),s=a("29fR"),l=(a("zKZe"),a("7I9Z")),o={loading:!1,tip:"\u52a0\u8f7d\u4e2d..."};Object(l.a)({applicationList:function(e,t){void 0===e&&(e=o),void 0===t&&(t={});var a=t.payload,n=void 0===a?{}:a;switch(t.type){case"".concat("applicationList","/setState"):return Object.assign({},e,n);default:return Object.assign({},e)}}});a("Pwec");var r=a("CtXQ"),u=a.n(r),d=(a("5NDa"),a("5rEg")),m=a.n(d),f=(a("miYZ"),a("tsqr")),p=a.n(f),g=(a("2qtc"),a("kLXV")),b=a.n(g),v=(a("FZtP"),a("TeQF"),a("yXV3"),a("sMBO"),a("ma9I"),a("R5XZ"),a("tkto"),a("rB9j"),a("UxlC"),a("2B1R"),a("55Ip")),O=a("ZwoM"),E=a("N8SJ"),y=(a("OaEy"),a("2fM7")),h=a.n(y),j=(a("y8nQ"),a("Vl3Y")),C=a.n(j),w=(a("17x9"),C.a.Item),L={labelCol:{span:6},wrapperCol:{span:18}},S=h.a.Option,N=function(e){var t=e.form,a=e.selectObj,n=t.getFieldDecorator;return i.a.createElement(C.a,Object.assign({className:"ui-database-connection"},L),(a.loginParams||[]).map((function(e){if("product_version"===e.name){var t=e.optionCodes&&e.optionNames?e.optionCodes.map((function(t,a){return{name:e.optionNames[a],key:t}})):[];return i.a.createElement(w,{label:e.text,key:e.name},n("".concat(e.name),{initialValue:void 0,rules:[{required:!0,message:"\u8bf7\u586b\u5199".concat(e.text)}]})(i.a.createElement(h.a,{placeholder:"\u8bf7\u9009\u62e9".concat(e.text)},t.map((function(e){return i.a.createElement(S,{value:e.key,key:e.key},e.name)})))))}return i.a.createElement(w,{label:e.text,key:e.name},n("".concat(e.name),{initialValue:a.companyId||"",rules:[{required:!0,message:"\u8bf7\u586b\u5199".concat(e.text)}]})(i.a.createElement(m.a,{placeholder:"\u8bf7\u586b\u5199".concat(e.text),autoComplete:"off"})))})))};N.defaultProps={selectObj:{}},N.propTypes={};var k=C.a.create()(N),I=a("oGyi"),x=(a("g9YV"),a("wCAj")),R=a.n(x),P=C.a.Item,V={labelCol:{span:6},wrapperCol:{span:18}},A=function(e){var t=e.selectObj,a=e.form,c=e.setMainLoading,s=Object(n.useState)(""),l=s[0],o=s[1],r=Object(n.useState)(!1),u=r[0],d=r[1],f=Object(n.useState)([]),g=f[0],v=f[1],O=Object(n.useState)({selectedRowKeys:[],selectedRows:[]}),E=O[0],y=O[1],j=a.getFieldDecorator,w=a.getFieldsValue,L=a.setFieldsValue,S=w().verificationMethod,N={selectedRowKeys:E.selectedRowKeys,width:60,onChange:function(e,t){E.selectedRowKeys.length>=1?y({selectedRowKeys:[e[1]],selectedRows:t.filter((function(t){return t.id===e[1]}))}):y({selectedRowKeys:e,selectedRows:t})}};return i.a.createElement(i.a.Fragment,null,i.a.createElement(C.a,Object.assign({className:"ui-database-connection"},V),i.a.createElement(P,{label:"\u6570\u636e\u5e93\u7c7b\u578b"},j("databaseType",{initialValue:t.typeid})(i.a.createElement(h.a,{disabled:!0},i.a.createElement(h.a.Option,{value:t.typeid},l||t.dbTypeName||t.typeName)))),"0"!==t.typeid&&i.a.createElement(P,{label:"\u9009\u62e9\u6570\u636e\u5e93\u8def\u5f84"},j("instance",{initialValue:t.instance||"",rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u6570\u636e\u5e93\u8def\u5f84"}]})(i.a.createElement(m.a,{placeholder:"\u8bf7\u9009\u62e9\u6570\u636e\u5e93\u8def\u5f84",onFocus:function(e){e.target.blur(),ClientAPI.SetAddress().then((function(e){e.instance&&(o(e.dbTypeName||""),L({instance:e.instance||""}))})).catch((function(e){L({instance:"\u6211\u6ca1\u8fde\u4e0a \u6a21\u62df\u4e0b"}),p.a.error(e.msg||"\u8bbe\u7f6e\u76ee\u5f55\u5931\u8d25\uff01")}))},autoComplete:"off"}))),"0"===t.typeid&&i.a.createElement(i.a.Fragment,null,i.a.createElement(P,{label:"IP/\u4e3b\u673a\u540d"},j("ipHostName",{initialValue:t.instance})(i.a.createElement(m.a,{addonAfter:i.a.createElement("span",{style:{cursor:"pointer",color:"#1890ff"},onClick:function(){c(!0),ClientAPI.getInstanse(JSON.stringify({})).then((function(e){c(!1),d(!0),v(e.list.map((function(e,t){return Object.assign({},e,{id:"".concat(t)})})))})).catch((function(e){c(!1),p.a.error(e.msg||"\u83b7\u53d6\u8f6f\u4ef6\u7c7b\u578b\u5931\u8d25\uff01")}))}},"\u5b9e\u4f8b\u540d")}))),i.a.createElement(P,{label:"\u9a8c\u8bc1\u65b9\u5f0f"},j("verificationMethod",{initialValue:0})(i.a.createElement(h.a,null,i.a.createElement(h.a.Option,{value:0},"windows \u9a8c\u8bc1"),i.a.createElement(h.a.Option,{value:1},"SQL SERVER\u9a8c\u8bc1")))),1===S&&i.a.createElement(i.a.Fragment,null,i.a.createElement(P,{label:"\u767b\u5f55\u540d"},j("name",{initialValue:t.name,rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u767b\u5f55\u540d"}]})(i.a.createElement(m.a,{placeholder:"\u8bf7\u8f93\u5165\u767b\u5f55\u540d",autoComplete:"off"}))),i.a.createElement(P,{label:"\u5bc6\u7801"},j("password",{initialValue:t.password,rules:[{required:!1,message:"\u8bf7\u8f93\u5165\u5bc6\u7801"}]})(i.a.createElement(m.a.Password,{placeholder:"\u8bf7\u8f93\u5165\u5bc6\u7801",autoComplete:"off"})))))),i.a.createElement(b.a,{title:"\u4e0b\u9762\u663e\u793a\u7684\u662f\u5f53\u524d\u7f51\u7edc\u4e0a\u53d1\u73b0\u7684SQL server",visible:u,onOk:function(){L({ipHostName:(E.selectedRows[0]||{}).name}),d(!1)},onCancel:function(){d(!1)},width:600},i.a.createElement(R.a,{bordered:!0,pagination:!1,rowKey:"id",rowSelection:N,dataSource:g,scroll:{y:300},columns:[{width:280,title:"\u5b9e\u4f8b\u540d",dataIndex:"name",align:"left"},{width:120,title:"ip\u5730\u5740",dataIndex:"address",align:"left"},{width:80,title:"\u7aef\u53e3\u53f7",dataIndex:"port",align:"center"}]})))};A.propTypes={};var K=C.a.create()(A),T=(a("IeaC"),l.b.dispatch),D={setAccountList:function(e){T({type:"user/setState",payload:e})},setLoadingObj:function(e,t){void 0===e&&(e=!1),T({type:"applicationList/setState",payload:{loading:e,tip:t||"\u52a0\u8f7d\u4e2d..."}})}},F=function(){var e=Object(n.useRef)(null),t=Object(v.useHistory)(),a=Object(n.useState)({tabsData:[],activeKey:"",activeIndex:0,tabsDataList:[]}),c=a[0],s=a[1],l=Object(n.useState)({}),o=l[0],r=l[1],d=Object(n.useState)(!1),f=d[0],g=d[1],y=Object(n.useState)(!1),h=y[0],j=y[1],C=Object(n.useState)(!1),w=C[0],L=C[1],S=Object(n.useState)(""),N=S[0],x=S[1],R=c.tabsData,P=c.tabsDataList,V=c.activeKey,A=c.activeIndex,T=Object(n.useState)(!1),F=T[0],q=T[1],J=Object(n.useState)(0),M=J[0],Z=J[1],B=Object(n.useState)("\u767b\u5f55"),H=B[0],Q=B[1],X=Object(n.useState)(""),U=X[0],Y=X[1];Object(n.useEffect)((function(){D.setLoadingObj(!0,"\u6b63\u5728\u83b7\u53d6\u8f6f\u4ef6\u7c7b\u578b..."),ClientAPI.AllType().then((function(e){var t,a;D.setLoadingObj(!1),s(Object.assign({},c,{tabsData:(null==e?void 0:e.list)||[],activeKey:(null==e||null==(t=e.list[0])?void 0:t.id)||"",tabsDataList:(null==e||null==(a=e.list[0])?void 0:a.list)||[]}))})).catch((function(e){D.setLoadingObj(!1),p.a.error(e.msg||"\u83b7\u53d6\u8f6f\u4ef6\u7c7b\u578b\u5931\u8d25\uff01")}))}),[]),console.log("appData:",c);return i.a.createElement("div",{className:"applicationListLayer"},i.a.createElement("div",{className:"headerBG"},i.a.createElement("div",{className:"left"},i.a.createElement("div",{className:"h3"},"\u9009\u62e9\u8f6f\u4ef6"),i.a.createElement("div",{className:"nav"},U&&i.a.createElement("div",{className:"itemNav active",key:"-99"},i.a.createElement("em",{className:"txt"},"\u641c\u7d22")),R.map((function(e,t){return i.a.createElement("div",{className:"itemNav ".concat(e.id===V?"active":""),key:e.id,onClick:function(){return function(e,t){Y(""),s(Object.assign({},c,{tabsDataList:e.list,activeKey:e.id,activeIndex:t})),Y("")}(e,t)}},i.a.createElement("em",{className:"txt"},e.name))})),i.a.createElement("div",{className:"whiteHover",style:{left:"".concat(68*A,"px")}}))),i.a.createElement("div",{className:"search"},i.a.createElement(m.a.Search,{placeholder:"\u8bf7\u8f93\u5165\u4f9b\u5e94\u5546\u6216\u8f6f\u4ef6\u540d\u79f0",style:{width:240,height:28,verticalAlign:"middle",borderRadius:14,overflow:"hidden"},allowClear:!0,size:"small",value:U,onChange:function(e){var t,a=null==(t=e.target)?void 0:t.value;""===a?(s(Object.assign({},c,{activeKey:R[0].id,tabsDataList:R[0].list,activeIndex:0})),Y("")):function(e){if(""!==e){var t=[];R.forEach((function(a){if(a.list){var n=e?a.list.filter((function(t){return-1!==t.name.toLowerCase().indexOf(e.toLowerCase())}))||[]:a.list;t=t.concat(n)}})),s(Object.assign({},c,{tabsDataList:t,activeIndex:0,activeKey:"-99"})),Y(e)}}(a),Y(a)}}))),i.a.createElement("div",{className:"listContent"},i.a.createElement("div",{className:"civ"},P.map((function(e){return i.a.createElement("div",{className:"listItem",key:"".concat(e.appid,"-").concat(e.value)},i.a.createElement("i",{className:"iconfont icon-wenben"}),i.a.createElement("div",{className:e.loginLink?"text":"text large",onClick:function(){return function(e){var t=Object.assign({},e,{names:e.name}),a={appid:t.appid,typeid:t.typeid,value:t.value};r(t),1===+t.isSaaS?g(!0):1===+t.isOpenEXE?b.a.confirm({title:'\u8be5\u7cfb\u5217\u5fc5\u987b\u4f7f\u75281.0\u5bfc\u8d26\u53d6\u6570\uff0c\u70b9\u51fb"\u786e\u5b9a"\u6253\u5f00\u5bfc\u8d261.0\u5ba2\u6237\u7aef',content:"",onOk:function(){D.setLoadingObj(!0,"\u6b63\u5728\u83b7\u53d6\u8f6f\u4ef6\u7c7b\u578b..."),ClientAPI.Connect(JSON.stringify(a)).then((function(){D.setLoadingObj()})).catch((function(e){D.setLoadingObj(),p.a.error(e.msg||"\u83b7\u53d6\u8f6f\u4ef6\u7c7b\u578b\u5931\u8d25\uff01")})),r({})},onCancel:function(){r({})}}):(D.setLoadingObj(!0,"\u6b63\u5728\u83b7\u53d6\u8f6f\u4ef6\u7c7b\u578b..."),ClientAPI.Connect(JSON.stringify(a)).then((function(e){r(Object.assign({},t,e)),D.setLoadingObj(),j(!0)})).catch((function(e){D.setLoadingObj(),p.a.error(e.msg||"\u83b7\u53d6\u8f6f\u4ef6\u7c7b\u578b\u5931\u8d25\uff01")})))}(e)}},e.name),1===+e.isNewVersion&&i.a.createElement("i",{className:"iconfont icon-new"}),1===+e.isContinuous&&i.a.createElement(E.a,{type:"more"}),1===+e.isSingleLogin&&i.a.createElement(E.a,{type:"single"}),1===+e.bAsset&&i.a.createElement(E.a,{type:"capital"}),i.a.createElement("div",{className:"url",title:e.loginLink,onClick:function(){return t=e.loginLink,void ClientAPI.openUrl(t);var t}},e.loginLink))})))),i.a.createElement(O.a,{right:function(){return i.a.createElement("div",{className:"notice",onClick:function(){return L(!0)}},i.a.createElement(u.a,{type:"exclamation-circle",style:{margin:"2px 5px 0 0"}}),"\u4e0a\u4f20dat\u6587\u4ef6")}}),f&&i.a.createElement(b.a,{title:"\u767b\u5f55".concat(o.names),wrapClassName:"ssssModal",visible:f,onOk:function(){e.current.validateFields((function(e,a){if(!e){var n=/(^\s*)|(\s*$)/g,i={};Object.keys(a).forEach((function(e){i[e]=a[e].replace(n,"")}));var c={loginParams:i,isRefreshList:1,name:o.name};console.log("loginParams:",i),function e(a,n){var i=n||0;q(!0),ClientAPI.getSaaS(JSON.stringify(Object.assign({},a,{testNum:i}))).then((function(n){console.log("patrolLoginInfo:",n);var c=n.percentage,s=n.loginStatus,l=n.msg;"success"===s?(Z(100),t.push({pathname:"/helper/account-list",state:{dataList:n.list||[],queryVal:a,isSaas:!0,selectObj:o}}),p.a.success("\u767b\u5f55SaaS\u6210\u529f"),setTimeout((function(){g(!1),q(!1),Z(0),Q("\u767b\u5f55")}),1e3)):"fail"===s?(g(!1),q(!1),p.a.error(l||"\u767b\u5f55SaaS\u5931\u8d25\uff01"),Z(0),Q("\u767b\u5f55")):setTimeout((function(){Q(l),Z(+c),e(a,i+1)}),500)})).catch((function(e){g(!1),q(!1),p.a.error(e.msg||"\u767b\u5f55SaaS\u5931\u8d25\uff01"),Z(0),Q("\u767b\u5f55")}))}(c)}}))},onCancel:function(){g(!1),setTimeout((function(){r({})}),300)},width:428,okText:"\u786e\u5b9a",maskClosable:!1,getContainer:!1},i.a.createElement(k,{ref:e,selectObj:o})),h&&i.a.createElement(b.a,{title:"\u8fde\u63a5\u6570\u636e\u5e93",visible:h,onOk:function(){e.current.validateFields((function(e,a){if(!e){var n=a.databaseType,i=a.ipHostName,c=a.verificationMethod,s=a.name,l=a.password,r={instance:a.instance||i};0===+n&&1===+c&&(r.name=s,r.password=l),D.setLoadingObj(!0,"\u6b63\u5728\u8fde\u63a5\u6570\u636e\u5e93..."),ClientAPI.LinkDB(JSON.stringify(r)).then((function(e){p.a.success("\u6570\u636e\u5e93\u8fde\u63a5\u6210\u529f"),t.push({pathname:"/helper/account-list",state:{dataList:e.list||[],queryVal:r,isSaas:!1,selectObj:o}}),D.setLoadingObj()})).catch((function(e){D.setLoadingObj(),p.a.error(e.msg||"\u8fde\u63a5\u6570\u636e\u5e93\u5931\u8d25\uff01")}))}}))},onCancel:function(){j(!1),setTimeout((function(){r({})}),300)},width:550,style:{top:"10vh"},okText:"\u4e0b\u4e00\u6b65",maskClosable:!1,getContainer:!1},i.a.createElement(K,{ref:e,selectObj:o,setMainLoading:D.setLoadingObj})),w&&i.a.createElement(b.a,{title:"\u624b\u52a8\u4e0a\u4f20\u6570\u636e",visible:w,onOk:function(){N?(D.setLoadingObj(!0),ClientAPI.datUpLoad(JSON.stringify({address:N})).then((function(e){if(0===+e.resultStatus)return b.a.success({content:"\u4e0a\u4f20\u6210\u529f"}),void D.setLoadingObj(!1);b.a.error({title:"\u3010".concat(e.name,"\u3011 \u4e0a\u4f20\u5931\u8d25"),content:"".concat(e.checkResult)}),console.log("fail:",e),D.setLoadingObj(!1)})).catch((function(e){b.a.error({title:"\u3010".concat(e.name,"\u3011 \u4e0a\u4f20\u5931\u8d25"),content:"".concat(e.checkResult)}),D.setLoadingObj(!1)}))):p.a.error("\u8bf7\u9009\u62e9\u6587\u4ef6\uff01")},onCancel:function(){return L(!1)},width:550,getContainer:!1},i.a.createElement("p",{style:{color:"#ff8d00"}},"\u6e29\u99a8\u63d0\u793a\uff1a\u672c\u6b21\u64cd\u4f5c\u4e3b\u8981\u662f\u5bf9\u901a\u8fc7\u8bfa\u8bfa\u5bfc\u8d26\u5de5\u5177\u5bfc\u51fa\u7684dat\u6587\u4ef6\u8fdb\u884c\u624b\u52a8\u4e0a\u4f20\u64cd\u4f5c\u3002"),i.a.createElement(m.a,{placeholder:"\u8bf7\u9009\u62e9\u9700\u8981\u4e0a\u4f20\u7684\u6570\u636e\u6587\u4ef6",onFocus:function(e){e.target.blur(),ClientAPI.chooseFile(JSON.stringify({})).then((function(e){e.address&&x(e.address)})).catch((function(e){p.a.error(e.msg||"\u8bbe\u7f6e\u76ee\u5f55\u5931\u8d25\uff01")}))},autoComplete:"off",value:N})),F&&i.a.createElement(b.a,{title:null,visible:F,width:550,getContainer:!1,footer:null,closable:!1,centered:!0},i.a.createElement(I.a,{maxPercent:M,stepName:H})))};t.default=function(){var e=Object(c.useSelector)((function(e){return e.applicationList})),t=e.loading,a=e.tip;return i.a.createElement(s.a,{spinning:t,tip:a},i.a.createElement(F,null))}}}]);